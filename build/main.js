function getUser(e){return $.get("https://randomuser.me/api/",function(o){result=o.results[0].user,console.log(result);var t=JSON.stringify(result);localStorage.setItem(e,t)})}function drawBoard(){if(canvas=document.getElementById("canvas"),context=canvas.getContext("2d"),!selection)for(var e=0;11>e;e++)if(0===e||10===e)for(var o=0;9>o;o++)o>2&&6>o?colorSquare(e,o,"green"):colorSquare(e,o,"black");else if(1===e||2===e||8===e||9===e)for(var o=0;9>o;o++)o>2&&6>o?colorSquare(e,o,"rgb(147,255,88)"):colorSquare(e,o,"rgb(184,255,138)");else for(var o=0;9>o;o++)colorSquare(e,o,"rgb(184,255,138)");for(var t=.5;boardSizex>t;t+=boardStep)context.moveTo(t,.5),context.lineTo(t,boardSizey);for(var l=.5;boardSizey>l;l+=boardStep)context.moveTo(.5,l),context.lineTo(boardSizey,l);for(context.strokeStyle="#eee",context.stroke(),renderFigure(ball),e=0;e<gameObjects.length;e++)renderFigure(gameObjects[e]);context.fillStyle="rgb(250, 50, 50)",context.font="24px Helvetica",context.textAlign="left",context.textBaseline="top",context.fillText("moves left: "+turnCount,5,0),context.fillStyle="rgb(250, 50, 50)",context.font="24px Helvetica",context.textAlign="left",context.textBaseline="top",context.fillText("kicks left: "+kickCount,5,40),$("#black-score").text("Score: "+blackscore),$("#white-score").text("Score: "+whitescore),canvas.addEventListener("click",canvasClick,!1)}function canvasClick(e){var o=getCursorPosition(e);for(l=0;l<gameObjects.length;l++){if(gameObjects[l].selected&&ball.selected){if((o.row>0||o.column<6&&o.column>2)&&(o.row<10||o.column<6&&o.column>2)){if(gameObjects[l].row===o.row&&gameObjects[l].column===o.column)return gameObjects[l].selected=!1,selection=!1,ball.selected=!1,console.log("deselected"),void drawBoard();if(Math.abs(gameObjects[l].row-o.row)<=1&&Math.abs(gameObjects[l].column-o.column)<=1){for(var t=gameObjects[l],l=0,r=!1;l<gameObjects.length;){if(gameObjects[l].row===o.row&&gameObjects[l].column===o.column){r=!0;break}l++}r||ballMovement(o,t)}}return}if(gameObjects[l].selected)return gameObjects[l].row===o.row&&gameObjects[l].column===o.column?(gameObjects[l].selected=!1,selection=!1,console.log("deselected"),void drawBoard()):o.row===ball.row&&ball.column===o.column&&Math.abs(ball.row-gameObjects[l].row)<2&&Math.abs(ball.column-gameObjects[l].column)<2?(colorSquare(o.row,o.column,"red"),ball.selected=!0,void drawBoard()):void(validateMove(gameObjects[l],o)&&(gameObjects[l].row=o.row,gameObjects[l].column=o.column,gameObjects[l].selected=!1,selection=!1,"king"===gameObjects[l].type&&turnCount--,drawBoard(),console.log(turnCount),0===turnCount&&endTurn()))}for(l=0;l<gameObjects.length;l++)o.row===gameObjects[l].row&&o.column===gameObjects[l].column&&gameObjects[l].color==turn&&(gameObjects[l].selected=!0,console.log("you are selected"),colorSquare(o.row,o.column,"red"),selection=!0);drawBoard()}function endTurn(){turnCount=3,kickCount=3,console.log("end of turn"),$(".player").toggleClass("active"),turn="white"===turn?"black":"white",drawBoard()}function getCursorPosition(e){var o,t;void 0!=e.pageX&&void 0!=e.pageY?(o=e.pageX,t=e.pageY):(o=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,t=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),o-=canvas.offsetLeft,t-=canvas.offsetTop,o=Math.min(o,boardStep*boardStep),t=Math.min(t,boardStep*boardStep);var l=new Cell(Math.floor(t/boardStep),Math.floor(o/boardStep));return l}function Cell(e,o){this.row=e,this.column=o}function colorSquare(e,o,t){context.fillStyle=t,context.fillRect(o*boardStep+1,e*boardStep+1,boardStep-1,boardStep-1)}function figure(e,o,t,l){this.type=e,this.image="images/"+o+"-"+e+".png",this.column=t,this.row=l,this.color=o,this.selected=!1,this.startRow=l,this.startColumn=t}function renderFigure(e){e.imageObj?context.drawImage(e.imageObj,e.column*boardStep,e.row*boardStep,boardStep,boardStep):(e.imageObj=new Image,e.imageObj.src=e.image,e.imageObj.onload=function(){context.drawImage(e.imageObj,e.column*boardStep,e.row*boardStep,boardStep,boardStep)})}function validateMove(e,o){if("pawn"===e.type&&"white"===e.color)return o.row<10&&o.row>7&&o.column<6&&o.column>2?!0:!1;if("pawn"===e.type&&"black"===e.color)return o.row<3&&o.row>0&&o.column<6&&o.column>2?!0:!1;if("king"===e.type&&o.row>0&&o.row<10){if(o.row>7&&o.row<10&&o.column>2&&o.column<6)return!1;if(o.row>0&&o.row<3&&o.column>2&&o.column<6)return!1;if(Math.abs(e.row-o.row)<2&&Math.abs(e.column-o.column)<2){for(var t=!0,l=0;l<gameObjects.length;l++)o.row===gameObjects[l].row&&o.column===gameObjects[l].column&&(t=!1);return t}}return!1}function ballMovement(e,o){if(ball.row=e.row,ball.column=e.column,ball.row===o.row)if(console.log("in row loop"),ball.column>o.column){for(var t=void 0,l=void 0,r=0;r<gameObjects.length;r++)gameObjects[r].row===ball.row&&gameObjects[r].column>ball.column&&(t=gameObjects[r].column-1,l?l>t&&(l=t):l=t);ball.column=l||8}else{for(var t=void 0,l=void 0,r=0;r<gameObjects.length;r++)gameObjects[r].row===ball.row&&gameObjects[r].column<ball.column&&(t=gameObjects[r].column+1,l?t>l&&(l=t):l=t);ball.column=l||0}if(ball.column===o.column)if(console.log("in column loop"),ball.row>o.row){var a=9;ball.column>2&&ball.column<6&&(a=10);for(var t=void 0,l=void 0,r=0;r<gameObjects.length;r++)gameObjects[r].column===ball.column&&gameObjects[r].row>ball.row&&(t=gameObjects[r].row-1,l?l>t&&(l=t):l=t);ball.row=l||a}else{var a=1;ball.column>2&&ball.column<6&&(a=0);for(var t=void 0,l=void 0,r=0;r<gameObjects.length;r++)gameObjects[r].column===ball.column&&gameObjects[r].row<ball.row&&(t=gameObjects[r].row+1,l?t>l&&(l=t):l=t);ball.row=l||a}if(ball.column<o.column&&ball.row<o.row)for(;ball.column>0&&(ball.row>1||1===ball.row&&ball.column<7&&ball.column>3);){trigger=!1,ball.column--,ball.row--;for(var r=0;r<gameObjects.length;r++)ball.row===gameObjects[r].row&&ball.column===gameObjects[r].column&&(trigger=!0,ball.column++,ball.row++);if(trigger)break}if(ball.column>o.column&&ball.row>o.row)for(;ball.column<8&&(ball.row<9||9===ball.row&&ball.column<5&&ball.column>1);){trigger=!1,ball.column++,ball.row++;for(var r=0;r<gameObjects.length;r++)ball.row===gameObjects[r].row&&ball.column===gameObjects[r].column&&(trigger=!0,ball.column--,ball.row--);if(trigger)break}if(ball.column>o.column&&ball.row<o.row)for(;ball.column<8&&(ball.row>1||1===ball.row&&ball.column<5&&ball.column>1);){trigger=!1,ball.column++,ball.row--;for(var r=0;r<gameObjects.length;r++)ball.row===gameObjects[r].row&&ball.column===gameObjects[r].column&&(trigger=!0,ball.column--,ball.row++);if(trigger)break}if(ball.column<o.column&&ball.row>o.row)for(;ball.column>0&&(ball.row<9||9===ball.row&&ball.column<7&&ball.column>3);){trigger=!1,ball.column--,ball.row++;for(var r=0;r<gameObjects.length;r++)ball.row===gameObjects[r].row&&ball.column===gameObjects[r].column&&(trigger=!0,ball.column++,ball.row--);if(trigger)break}kickCount--,0===kickCount&&endTurn(),10===ball.row&&(blackscore+=1,"black"===turn&&$(".player").toggleClass("active"),turn="white",resetBoard()),0===ball.row&&(whitescore+=1,"white"===turn&&$(".player").toggleClass("active"),turn="black",resetBoard()),o.selected=!1,ball.selected=!1,selection=!1,drawBoard()}function resetBoard(){turnCount=3,kickCount=3;for(var e=0;e<gameObjects.length;e++)gameObjects[e].row=gameObjects[e].startRow,gameObjects[e].column=gameObjects[e].startColumn;ball.row=ball.startRow,ball.column=ball.startColumn}function saveGame(e){var o=[];o.push(gameObjects),o.push(ball),o.push(turnCount),o.push(kickCount),o.push(whitescore),o.push(blackscore),o.push(turn),console.log(o),localStorage.setItem(e,JSON.stringify(o))}function loadGame(e){var o=JSON.parse(localStorage.getItem(e));console.log(o),turn=o.pop(),blackscore=o.pop(),whitescore=o.pop(),kickCount=o.pop(),turnCount=o.pop();var t=o.pop();ball.row=t.row,ball.column=t.column;for(var l=o.pop(),r=0;r<l.length;r++)gameObjects[r].row=l[r].row,gameObjects[r].column=l[r].column;drawBoard()}$(document).ready(function(){function e(e){var t=JSON.parse(localStorage.getItem(e)),l=document.getElementById(e);$(l).prevAll("img").attr("src",t.picture.thumbnail),$(l).prevAll(".name").text(o(t.name.title)+" "+o(t.name.first)+" "+o(t.name.last)),$(l).prevAll(".username").text(t.username)}function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}e("userone"),e("usertwo"),$(".get-player").on("click",function(){var e=$(this).attr("data");$.when(getUser(e)).then(function(){userObject=JSON.parse(localStorage.getItem($(this).attr("data"))),$(this).prevAll("img").attr("src",userObject.picture.thumbnail),$(this).prevAll(".name").text(o(userObject.name.title)+" "+o(userObject.name.first)+" "+o(userObject.name.last)),$(this).prevAll(".username").text(userObject.username)}.bind(this))})}),$(document).ready(function(){drawBoard()}),$(".reset").on("click",function(){resetBoard(),selection=!1,kickCount=3,turnCount=3,turn="white",whitescore=0,blackscore=0,drawBoard()});var selection=!1,turnCount=3,kickCount=3,turn="white",ball=new figure("ball","black",4,5),whiteKeeper=new figure("pawn","white",4,9),blackKeeper=new figure("pawn","black",4,1),strikerOneWhite=new figure("king","white",5,7),strikerOneBlack=new figure("king","black",5,3),strikerTwoWhite=new figure("king","white",3,7),strikerTwoBlack=new figure("king","black",3,3),strikerThreeWhite=new figure("king","white",4,7),strikerThreeBlack=new figure("king","black",4,3),gameObjects=[whiteKeeper,blackKeeper,strikerOneWhite,strikerOneBlack,strikerTwoWhite,strikerTwoBlack,strikerThreeWhite,strikerThreeBlack],boardSizex=679,boardSizey=835,boardStep=75,whitescore=0,blackscore=0;$(document).ready(function(){function e(e,o){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){$(o).attr("src",e.target.result)},t.readAsDataURL(e.files[0])}}$(".sbmt-plyr").on("click",function(o){o.preventDefault(),$("input[value='white']").is(":checked")?(e(document.getElementById("imgInp"),"#player2"),$(".player2").next().text($("input[id='name']").val()).next().text($("input[id='username']").val())):(e(document.getElementById("imgInp"),"#player1"),$(".player1").next().text($("input[id='name']").val()).next().text($("input[id='username']").val()))}),$(".save").on("click",function(){var e=prompt("Name Game to Save");saveGame(e)}),$(".load").on("click",function(){var e=prompt("Name of Game");loadGame(e)})});